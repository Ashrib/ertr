// const preData = window.localStorage.getItem(JSON.parse("Reserved seats"));
// const seatsArray = [...preData];
// for(let keey in seatsArray){
    
// }


let allMoives = [
    {
        "type": "Hollywood",
        "movies":[
            {   "movieInfo": {
                    "keyname":"holly1",
                    "details":{
                        "name": "THOR: LOVE AND THUNDER",
                        "categories": "Action, Adventure",
                        "language": "English",
                        "info": "Thor enlists the help of Valkyrie, Korg and ex-girlfriend Jane Foster to fight Gorr the God Butcher, who intends to make the gods ex",
                        "poster": "https://www.nueplex.com/assets/uploads/movie/1655543340-18-06-2022-1.jpg",
                        "seats": {
                            "no.of seats": "20",
                            "seat": {
                                "s1": "no booking",
                                "s2": "no booking",
                                "s3": "no booking",
                                "s4": "no booking",
                                "s5": "no booking",
                                "s6": "no booking",
                                "s7": "no booking",
                                "s81": "no booking",
                                "s9": "no booking",
                                "s10": "no booking",
                                "s11": "no booking",
                                "s12": "no booking",
                                "s13": "no booking",
                                "s14": "no booking",
                                "s15": "no booking",
                                "s16": "no booking",
                                "s17": "no booking",
                                "s18": "no booking",
                                "s19": "no booking",
                                "s20": "no booking",
                            }
                        }
                    }
                }
                
            },
            {
                "movieInfo": {
                    "keyname": "holly2",
                    "details":{
                        "name": "JURASSIC WORLD DOMINION",
                        "categories": "Action, Adventure, Sci-Fi",
                        "language": "English",
                        "info": "This summer, experience the epic conclusion to the Jurassic era as two generations unite for the first time. Chris Pratt and Bryce D",
                        "poster": "https://www.nueplex.com/assets/uploads/movie/1652972152-19-05-2022-1.jpg",
                        "seats": {
                        "no.of seats": "20",
                        "seat": {
                            "s1": "no booking",
                            "s2": "no booking",
                            "s3": "no booking",
                            "s4": "no booking",
                            "s5": "no booking",
                            "s6": "no booking",
                            "s7": "no booking",
                            "s81": "no booking",
                            "s9": "no booking",
                            "s10": "no booking",
                            "s11": "no booking",
                            "s12": "no booking",
                            "s13": "no booking",
                            "s14": "no booking",
                            "s15": "no booking",
                            "s16": "no booking",
                            "s17": "no booking",
                            "s18": "no booking",
                            "s19": "no booking",
                            "s20": "no booking",
                    }
                        }
                    }
                }
                
                
            },
            {
                "movieInfo": {
                    "keyname": "holly3",
                    "details":{
                        "name": "BULLET TRAIN",
                        "categories": " Action, Thriller",
                        "language": "English",
                        "info": "In Bullet Train, Brad Pitt stars as Ladybug, an unlucky assassin determined to do his job peacefully after one too many gigs gone of",
                        "poster": "https://www.nueplex.com/assets/uploads/movie/1655543531-18-06-2022-1.jpg",
                        "seats": {
                            "no.of seats": "20",
                            "seat": {
                                "s1": "no booking",
                                "s2": "no booking",
                                "s3": "no booking",
                                "s4": "no booking",
                                "s5": "no booking",
                                "s6": "no booking",
                                "s7": "no booking",
                                "s81": "no booking",
                                "s9": "no booking",
                                "s10": "no booking",
                                "s11": "no booking",
                                "s12": "no booking",
                                "s13": "no booking",
                                "s14": "no booking",
                                "s15": "no booking",
                                "s16": "no booking",
                                "s17": "no booking",
                                "s18": "no booking",
                                "s19": "no booking",
                                "s20": "no booking",
                        }
                            }
                    }
                }
                
                
            }
        ]
    },
    {
        "type": "Pakistani",
        "movies":[
            {
                "movieInfo": {
                    "keyname": "pak1",
                    "details":{
                        "name": "QUAID-E-AZAM ZINDABAD",
                        "categories": "Action, Comedy",
                        "language": "Urdu",
                        "info": "Quaid-e-Azam Zindabad is an action comedy Film, under the banner of Filmwala Pictures, Produced bby Fizza Ali Meerza & Directed",
                        "poster": "https://www.nueplex.com/assets/uploads/movie/1654324849-04-06-2022-1.jpg",
                        "seats": {
                        "no.of seats": "20",
                        "seat": {
                            "s1": "no booking",
                            "s2": "no booking",
                            "s3": "no booking",
                            "s4": "no booking",
                            "s5": "no booking",
                            "s6": "no booking",
                            "s7": "no booking",
                            "s81": "no booking",
                            "s9": "no booking",
                            "s10": "no booking",
                            "s11": "no booking",
                            "s12": "no booking",
                            "s13": "no booking",
                            "s14": "no booking",
                            "s15": "no booking",
                            "s16": "no booking",
                            "s17": "no booking",
                            "s18": "no booking",
                            "s19": "no booking",
                            "s20": "no booking",
                    }
                        }
                    }
                }
                
                
            },
            {
                "movieInfo": {
                    "keyname": "pak2",
                    "details":{
                        "name": "GHABRANA NAHI HAI",
                        "categories": "Action, Drama, Romance",
                        "language": "Urdu",
                        "info": "Ghabrana Nahi Hai is the upcoming blockbuster film from JB Films, Mastermind Films & Geo Films. The film stars the hugely popula",
                        "poster": "https://www.nueplex.com/assets/uploads/movie/1651516897-02-05-2022-1.jpg",
                        "seats": {
                        "no.of seats": "20",
                        "seat": {
                            "s1": "no booking",
                            "s2": "no booking",
                            "s3": "no booking",
                            "s4": "no booking",
                            "s5": "no booking",
                            "s6": "no booking",
                            "s7": "no booking",
                            "s81": "no booking",
                            "s9": "no booking",
                            "s10": "no booking",
                            "s11": "no booking",
                            "s12": "no booking",
                            "s13": "no booking",
                            "s14": "no booking",
                            "s15": "no booking",
                            "s16": "no booking",
                            "s17": "no booking",
                            "s18": "no booking",
                            "s19": "no booking",
                            "s20": "no booking",
                    }
                        }
                    }
                }
                
                
            },
            {
                "movieInfo": {
                    "keyname": "pak3",
                    "details":{
                        "name": "LONDON NAHI JAUNGA",
                        "categories": "Drama, Romance",
                        "language": "Urdu",
                        "info": "Sara seems to have always had a full life on the surface but she has always felt there is something out there that's missing, ti",
                        "poster": "https://www.nueplex.com/assets/uploads/movie/1656931635-04-07-2022-1.jpg",
                        "seats": {
                        "no.of seats": "20",
                        "seat": {
                            "s1": "no booking",
                            "s2": "no booking",
                            "s3": "no booking",
                            "s4": "no booking",
                            "s5": "no booking",
                            "s6": "no booking",
                            "s7": "no booking",
                            "s81": "no booking",
                            "s9": "no booking",
                            "s10": "no booking",
                            "s11": "no booking",
                            "s12": "no booking",
                            "s13": "no booking",
                            "s14": "no booking",
                            "s15": "no booking",
                            "s16": "no booking",
                            "s17": "no booking",
                            "s18": "no booking",
                            "s19": "no booking",
                            "s20": "no booking"
                    }
                        }
                    }
                }
                
                
            }
        ]  
    }
];

let mainDiv = document.getElementById("main-div");
let moivesBodyDiv = document.getElementById("movies-container");

for(let i of allMoives) {
    // console.log(i)
    let movieTypeDiv = document.createElement("div");
    movieTypeDiv.setAttribute("class", "movie-type-box");
    moivesBodyDiv.appendChild(movieTypeDiv);
    
    let heading = document.createElement("h1");
    heading.textContent = i.type;
    movieTypeDiv.appendChild(heading);

    let movieCardContainer = document.createElement("div");
    movieCardContainer.setAttribute("class", "movie-cards-container");
    movieTypeDiv.appendChild(movieCardContainer);
    
    for(let key in i.movies) {
        // movie cards
        let movieCard = document.createElement("div");
        movieCard.setAttribute("class", "movie-cards");
        movieCard.setAttribute("type",i.type);
        movieCard.setAttribute("key",i.movies[key].movieInfo.keyname);
        movieCard.setAttribute("onMouseover", "movieDetail(event)");
        movieCard.style.backgroundImage = `url(${i.movies[key].movieInfo.details.poster})`
        movieCardContainer.appendChild(movieCard);
        // movie cards detail
        let movieDetailBox = document.createElement("div");
        movieDetailBox.setAttribute("class", "movie-cards-detail");
        movieDetailBox.setAttribute("onMouseout", "movieDetailHide(event)");
        let movieTitle = document.createElement("h3");//movie title
        movieTitle.setAttribute("class", "movie-title");
        movieTitle.textContent = i.movies[key].movieInfo.details.name;
        movieDetailBox.appendChild(movieTitle);
        let movieCategorie = document.createElement("span");//categorie
        movieCategorie.setAttribute("class", "movie-categorie");
        movieCategorie.textContent = i.movies[key].movieInfo.details.categories;
        movieDetailBox.appendChild(movieCategorie);
        let movieLanguage = document.createElement("span");//language
        movieLanguage.setAttribute("class", "movie-language");
        movieLanguage.textContent = i.movies[key].movieInfo.details.language;
        movieDetailBox.appendChild(movieLanguage);
        let movieInfo = document.createElement("p");// info
        movieInfo.setAttribute("class", "movie-info");
        movieInfo.textContent = i.movies[key].movieInfo.details.info;
        movieDetailBox.appendChild(movieInfo);
        let movieBtn = document.createElement("button");// button
        movieBtn.setAttribute("class", "checkout-btn");
        movieBtn.setAttribute("onClick", "checkoutBtn(event)");
        movieBtn.textContent = "Check out";
        movieDetailBox.appendChild(movieBtn);
        movieCard.appendChild(movieDetailBox);
    }
};
function movieDetail(event){
    event.target.firstChild.style.display = "flex"
    // console.log(event.target.firstChild)
    // movieDetailBox.animate([    //animation
    // { transform: 'translateY(470px)'},
    // { transform: 'translateY(0px)'},
    // { transition: '1s'},
    // ],{
    //     duration: 500
    // });

}
function movieDetailHide(event){
    // console.log(event.target)
    event.target.parentNode.firstChild.style.display = "none"

}
let modalBackground = document.createElement("div");
modalBackground.setAttribute("id","modal-background");
mainDiv.appendChild(modalBackground);
let bookingModal = document.createElement("div");
bookingModal.setAttribute("id","booking-modal");
modalBackground.appendChild(bookingModal);
let modalClose = document.createElement("div");
modalClose.setAttribute("id","close-modal");
bookingModal.appendChild(modalClose);
let modalCloseFont = document.createElement("span");
modalCloseFont.setAttribute("id","close-font");
modalCloseFont.setAttribute("onClick", "closeModal()");
modalCloseFont.textContent = "X"
modalClose.appendChild(modalCloseFont);
let modalHeading = document.createElement("div");
modalHeading.setAttribute("id","modal-heading");
modalHeading.textContent = "Book Your Seat"
bookingModal.appendChild(modalHeading);
let seatsContainer = document.createElement("div");
seatsContainer.setAttribute("id","seats-container");
bookingModal.appendChild(seatsContainer);

let confirm_btn =  document.createElement("button");
confirm_btn.setAttribute("id" , "book-ok");
confirm_btn.setAttribute("onClick", "book()");
confirm_btn.textContent = "Book";
bookingModal.appendChild(confirm_btn);


function checkoutBtn(event){
    modalBackground.style.display = "flex";
    console.log(event.target.parentNode.parentNode)
    var typeAtt = event.target.parentNode.parentNode.getAttribute("type")
    var keyAtt = event.target.parentNode.parentNode.getAttribute("key")

    if(typeAtt === "Hollywood"){
        for(let key2 in allMoives[0].movies){
            // console.log(allMoives[0].movies[key2])
            if(allMoives[0].movies[key2].movieInfo.keyname === keyAtt){
                for(let key5 in allMoives[0].movies[key2].movieInfo.details.seats.seat){
                    console.log(allMoives[0].movies[key2].movieInfo.details.seats.seat[key5])
                    let seat = document.createElement("div");
                    seat.setAttribute("class","seat");
                    seat.setAttribute("onClick", "bookSeat(event)")
                    seat.textContent = key5
                    seatsContainer.appendChild(seat);
                }
            }
        }
    }
    else if(typeAtt === "Pakistani"){
        for(let key12 in allMoives[1].movies){
            if(allMoives[1].movies[key12].movieInfo.keyname === keyAtt){
                for(let key5 in allMoives[1].movies[key12].movieInfo.details.seats.seat){
                    console.log(allMoives[1].movies[key12].movieInfo.details.seats.seat[key5])
                    let seat = document.createElement("div");
                    seat.setAttribute("class","seat");
                    seat.setAttribute("onClick", "bookSeat(event)")
                    seat.textContent = key5
                    seatsContainer.appendChild(seat);

                }
            }
        }
    }
    



    console.log(event.target.parentNode.parentNode.getAttribute("style"))
    let url = event.target.parentNode.parentNode.getAttribute("style")
    bookingModal.setAttribute("style",url);

}
function closeModal(){
    modalBackground.style.display = "none";
    seatsContainer.innerHTML = null
}
let totalSeats = [];
function bookSeat(event) {
    event.target.style.backgroundColor = "green";
    event.target.style.transition = "1s";
    totalSeats.push(event.target.innerHTML);
    console.log(totalSeats)
}
function book(event) {
    if(totalSeats.length>1){
        window.localStorage.setItem("Reserved seats",JSON.stringify(totalSeats));
    }
}